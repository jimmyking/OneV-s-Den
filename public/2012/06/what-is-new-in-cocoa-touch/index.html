
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>WWDC 2012 Session笔记——200 What is new in Cocoa Touch - OneV's Den</title>
	<meta name="author" content="onevcat">

	
	<meta name="description" content="WWDC 2012 Session笔记——200 What Is New in Cocoa Touch 这是博主的WWDC2012笔记系列中的一篇，完整的笔记列表可以参看这里。如果您是首次来到本站，也许您会有兴趣通过RSS，或者通过页面下方的邮件订阅的方式订阅本站。 之前写过一篇iOS6 &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="OneV's Den" type="application/atom+xml">
	
	<link rel="canonical" href="http://blog.onevcat.com/2012/06/what-is-new-in-cocoa-touch/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">	
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		document.write("<img src='http://www.gravatar.com/avatar/" + MD5("onev@onevcat.com") + "?s=160' alt='Profile Picture' style='width: 160px;'");
	</script>
</div>
<h1><a href="/">OneV's Den</a></h1>
<p class="subtitle">thinking and recording</p>
<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
<hgroup>
  <h1><a href="/">OneV's Den</a></h1>
  
    <h2>thinking and recording</h2>
  
</hgroup>

</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">WWDC 2012 Session笔记——200 What Is New in Cocoa Touch</h1>
	<div class="entry-content" itemprop="articleBody"><p><!--:zh--><a href="http://www.onevcat.com/wp-content/uploads/2012/06/QQ20120620-1.png"><img class="aligncenter size-full wp-image-892" title="what-is-new-in-cocoa-touch" src="http://www.onevcat.com/wp-content/uploads/2012/06/QQ20120620-1.png" alt="" width="748" height="141" data-pinit="registered" /></a></p>

<p>这是博主的WWDC2012笔记系列中的一篇，完整的笔记列表可以参看<a href="http://www.onevcat.com/tag/wwdc/">这里</a>。如果您是首次来到本站，也许您会有兴趣通过<a href="http://www.onevcat.com/feed">RSS</a>，或者通过页面下方的邮件订阅的方式订阅本站。</p>

<p>之前写过<a href="http://www.onevcat.com/2012/06/%e5%bc%80%e5%8f%91%e8%80%85%e6%89%80%e9%9c%80%e8%a6%81%e7%9f%a5%e9%81%93%e7%9a%84ios6-sdk%e6%96%b0%e7%89%b9%e6%80%a7/">一篇iOS6 SDK新内容的总览</a>，从这篇开始，将对WWDC 2012的我个人比较感兴趣的Session进行一些笔记，和之后的笔记一起应该可以形成一个比较完整的WWDC 2012 Session部分的个人记录。</p>

<p>因为WWDC的内容可谓众多，我自觉不太可能看完所有Session(其实也没有这个必要..)，所以对于内容覆盖上可能有所欠缺。另外我本身也只是一个iOS开发初学者加业余爱好者，因此很多地方也都不明白，不理解，因此难免有各种不足。这些笔记的最大作用是给自己做一些留底，同时帮助理解Session的内容。欢迎高手善意地指出我的错误和不足..谢谢！</p>

<p>所有的WWDC 2012 Session的视频和讲义可以在<a href="https://developer.apple.com/videos/wwdc/2012/">这里</a>找到，如果想看或者下载的话可能需要一个野生开发者账号(就是不用交99美金那种)。iOS6 Beta和Xcode4.5预览版现在已经提供开发者下载(需要家养开发者的账号，就在iOS Resource栏里)，当然网上随便搜索一下不是开发者肯定也能下载到，不过如果你不太懂的话还是不建议尝试iOS6 Beta，有时间限制麻烦不说，而且可能存在各种bug，Xcode4.5预览版同理..</p>

<p><!--:--><!--more--><!--:zh--></p>

<p>作为WWDC 2012 Session部分的真正的开场环节，Session200可以说是iOS开发者必听必看的。这个Session介绍了关于Cocoa Touch的新内容，可以说是对整个iOS6 SDK的概览。</p>

<p>我也将这个Session作为之后可能会写的一系列的Session笔记的第一章，我觉得用Session 200作为一个开始，是再适合不过的了～</p>

<p><hr /></p>

<p><h3>更多的外观自定义</h3>
从iOS5开始，Apple就逐渐致力于标准控件的可自定义化，基本包括颜色，图片等的替换。对于标准控件的行为，Apple一向控制的还是比较严格的。而开发者在做app时，最好还是遵守Apple的人机交互手册来确定控件的功能，否则可能遇到意想不到的麻烦…</p>

<p>iOS6中Apple继续扩展了一些控件的可定义性。对于不是特别追求UI的开发团队或者实力有限的个人开发者来说这会是一个不错的消息，使用现有的资源和新加的API，可以快速开发出界面还不错的应用。
<h4>UIPopoverBackgroundView</h4>
UIPopoverBackgroundView是iOS5引入的，可以为popover自定义背景。iOS6中新加入了询问是否以默认方式显示的方法：
<pre>+ (BOOL)wantsDefaultContentAppearance;</pre>
返回NO的话，将以新的立体方式显示popover。</p>

<p>具体关于UIPopoverBackgroundView的用法，可以参考<a href="http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIPopoverBackgroundView_class/Reference/Reference.html">文档</a>
<h4>UIStepper</h4>
UIStepper也是iOS5引入的新控件，在iOS5中Apple为标准控件自定义做出了相当大的努力（可以参看WWDC2011的相关内容），而对于新出生的UIStepper却没有相应的API。在iOS6里终于加上了..可以说是预料之中的。
<pre>@property (nonatomic,retain) UIColor *tintColor;</pre>
这个属性定义颜色。</p>

<p><a href="http://www.onevcat.com/wp-content/uploads/2012/06/QQ20120620-2.png"><img class="aligncenter size-full wp-image-893" title="QQ20120620-2" src="http://www.onevcat.com/wp-content/uploads/2012/06/QQ20120620-2.png" alt="" width="299" height="121" data-pinit="registered" /></a>
<pre>- (void)setBackgroundImage:(UIImage*)image forState:(UIControlState)state;</pre></p>

<p>- (void)setDividerImage:(UIImage*)image forLeftSegmentState:(UIControlState)left rightSegmentState:(UIControlState)right; </p>

<p>- (void)setIncrementImage:(UIImage *)image forState:(UIControlState)state; </p>

<p>- (void)setDecrementImage:(UIImage *)image forState:(UIControlState)state;
可以定义背景图片、分隔图片和增减按钮的图片，都很简单明了，似乎没什么好说的。
<h4>￼￼￼UISwitch</h4>
同样地，现在有一系列属性可以自定义了。
<pre>@property (nonatomic, retain) UIColor *tintColor; </pre></p>

<p>@property (nonatomic, retain) UIColor *thumbTintColor; </p>

<p>@property (nonatomic, retain) UIImage *onImage; </p>

<p>@property (nonatomic, retain) UIImage *offImage;
其中thumbTintColor指的是开关的圆形滑钮的颜色。另外对于on和off时候可以自定义图片，那么很大程度上其实开关控件已经可以完全自定义，基本不再需要自己再去实现一次了..</p>

<p><a href="http://www.onevcat.com/wp-content/uploads/2012/06/QQ20120620-3.png"><img class="aligncenter size-full wp-image-894" title="QQ20120620-3" src="http://www.onevcat.com/wp-content/uploads/2012/06/QQ20120620-3.png" alt="" width="218" height="101" data-pinit="registered" /></a>
<h4>￼UINavigationBar &amp; UITabBar</h4>
加入了阴影图片的自定义：
<pre>@property (nonatomic,retain) UIImage *shadowImage;</pre>
这个不太清楚，没有自己实际试过。以后有机会做个小demo看看可以…
<h4>￼￼UIBarButtonItem</h4>
现在提供设置背景图片的API：
<pre>- (void)setBackgroundImage:(UIImage *)bgImage 
                  forState:(UIControlState)state 
                     style:(UIBarButtonItemStyle)style 
                barMetrics:(UIBarMetrics)barMetrics;</pre>
这个非常有用…以前在自定义UINavigationBar的时候，对于BarButtonItem的背景图片的处理非常复杂，通常需要和designer进行很多配合，以保证对于不同宽度的按钮背景图都可以匹配。现在直接提供一个UIImage就OK了..初步目测是用resizableImageWithCapInsets:做的实现..很赞，可以偷不少懒～</p>

<p><hr /></p>

<p><h3>UIImage的API变化</h3>
随着各类Retina设备的出现，对于图片的处理方面之前的API有点力不从心..反应最大的就是图片在不同设备上的适配问题。对于iPhone4之前，是普通图片。对于iPhone4和4S，由于Retina的原因，需要将图片宽高均乘2，并命名为@2x。对于遵循这样原则的图片，cocoa touch将会自动进行适配，将4个pixel映射到1个point上去，以保证图片不被拉伸以及比例的适配。对于iPhone开发，相关的文档是比较全面的，但是对于iPad就没那么好运了。Apple对于iPad开发的支持显然做的不如对iPhone那样好，所以很多iPad开发者在对图片进行处理的时候往往不知所措——特别是在retina的new iPad出现以后，更为严重。而这次UIImage的最大变化在于自己可以对scale进行指定了～这样虽然在coding的时候变麻烦了一点，但是图片的Pixel to Point对应关系可以自己控制了，在做适配的时候可以省心不少。具体相关几个API如下：
<pre>+ (UIImage *)imageWithData:(NSData *)data scale:(CGFloat)scale; </pre></p>

<p>- (id)initWithData:(NSData *)data scale:(CGFloat)scale; </p>

<p>+ (UIImage *)imageWithCIImage:(CIImage *)ciImage <br />
                        scale:(CGFloat)scale <br />
                  orientation:(UIImageOrientation)orientation;</p>

<p>- (id)initWithCIImage:(CIImage *)ciImage <br />
                scale:(CGFloat)scale <br />
          orientation:(UIImageOrientation)orientation;
指定scale=2之后即可对retina屏幕适配，相对来说还是比较简单的。</p>

<p><hr /></p>

<p><h3>UITableView的改动</h3>
UITableView就不多介绍了，基础中的基础…在iOS5引入StoryBoard之后，由StoryBoard生成的UITableViewController中对cell进行操作时所有的cell的alloc语句都可以不写，可以为cell绑定nib等，都简化了UITableView的使用。在iOS6中，对cell的复用有一些新的方法：
<pre>- (void)registerClass:(Class)cellClass forCellReuseIdentifier:(NSString *)identifier;</pre>
将一个类注册为某个重用ID。
<pre>- (id)dequeueReusableCellWithIdentifier:(NSString *)identifier 
                           forIndexPath:(NSIndexPath *)indexPath;</pre>
将指定indexPath的cell重用(若不能重用则返回nil，在StoryBoard会自动生成一个新的cell)。</p>

<p>另外，对UITableView的Header、Footer和Section分隔添加了一系列的property以帮助自定义，并且加入了关于Header和Footer的delegate方法。可以说对于TableView的控制更强大了…</p>

<p><hr /></p>

<p><h3>￼UIRefreshControl</h3>
这个是新加的东西，Apple的抄袭之作，官方版的下拉刷新。下拉刷新自出现的第一分钟起，就成为了人民群众喜闻乐见的手势，对于这种得到大众认可的手势，Apple是一定不会<br />
放过的。</p>

<p>相对与现在已有的开源下拉刷新来说，功能上还不那么强大，可自定义的内容不多，而且需要iOS6以后的系统，因此短期内还难以形成主流。但是相比开源代码，减去了拖源码加库之类的麻烦，并且和系统整合很好，再加上Apple的维护，相信未来是有机会成为主流的。现在来说的话，也就只是一种实现的选择而已。</p>

<p><hr /></p>

<p><h3>UICollectionView</h3>
这个是iOS的UIKit的重头戏..一定意义上可以把UICollectionView理解成多列的UITableView。开源社区有很多类似的实现，基本被称作GridView，我个人比较喜欢的实现有<a href="https://github.com/AlanQuatermain/AQGridView">AQGridView</a>和<a href="https://github.com/gmoledina/GMGridView">GMGridView</a>.开源实现基本上都是采用了和UITableView类似的方法，继承自UIScrollView，来进行多列排列。功能上来说相对都比较简单..</p>

<p>而UICollectionView可以说是非常强大..强大到基本和UITableView一样了..至少使用起来和UITableView一样，用惯了UITableView的童鞋甚至可以不用看文档就能上手。一样的DataSource和Delegate，不同之处在于多了一个Layout对象对其进行排列的设定，这个稍后再讲。我们先来看Datasource和Delegate的API
<pre>//DataSource</pre></p>

<p>-numberOfSectionsInCollectionView: </p>

<p>-collectionView:numberOfItemsInSection: </p>

<p>-collectionView:cellForItemAtIndexPath:
<pre>//Delegate </pre></p>

<p>-collectionView:shouldHighlightItemAtIndexPath: </p>

<p>-collectionView:shouldSelectItemAtIndexPath: </p>

<p>-collectionView:didSelectItemAtIndexPath:
没什么值得说的，除了名字以外，和UITableView的DataSource和Delegate没有任何不同。值得一提的是对应的UICollectionViewCell和UITableViewCell略有不同，UICollectionViewCell没有所谓的默认style，cell的子view自下而上有Background View、Selected Background View和一个Content View。开发者将自定义内容扔到Content View里即可。</p>

<p>需要认真看看的是Layout对象，它控制了整个UICollectionView中每个Section甚至Section中的每个cell的位置和关系。Apple提供了几种不错的Layout，足以取代现在常用的几个开源库，其中包括了像Linkedin和Pinterest的视图。可以说Apple对于利用AppStore这个平台，向第三方开发者进行学习的能力是超强的。</p>

<p>关于UICollectionView，在之后有两个session专门进行了讨论，我应该也会着重看一看相关内容，之后再进行补充了～</p>

<p><hr /></p>

<p><h3>UIViewController</h3>
<strong>这个绝对是重磅消息～</strong>一直以来我们会在viewDidUnload方法中做一些清空outlet或者移除observer的事情。在viewDidUnload中清理observer其实并不是很安全，因此在iOS5中Apple引入了viewWillUnload，建议开发者们在viewWillUnload的时候就移除observer。而对于出现内存警告时，某些不用的view将被清理，这时候将自动意外执行viewWillUnload和viewDidUnload，很可能造成莫名其妙的crash，而这种内存警告造成的问题又因为其随机性难以debug。</p>

<p>于是Apple这次做了一个惊人的决定，直接在<strong>iOS6里把viewWillUnload和viewDidUnload标注为了Deprecated</strong>，并且不再再会调用他们。绝大部分开发者其实是对iOS3.0以来就伴随我们的viewDidUnload是有深深的感情的，但是现在需要和这个方法说再见了。对于使用iOS6 SDK的app来说不应该再去实现这两个方法，而之前在这两个方法中所做的工作需要重新考虑其更合适的位置：比如在viewWillDisappear中去移除observer，在dealloc中将outlet置为nil等。</p>

<p><hr /></p>

<p><h3>状态恢复</h3>
在之前的一篇iOS6 SDK的简述中已经说过这个特性。简单讲就是对每个view现在都多了一个属性：
<pre>@property (nonatomic, copy) NSString *restorationIdentifier;</pre>
通过在用户点击Home键时的一系列delegate里对现有的view进行编码存储后，在下一次打开文件时进行解码恢复。更多的详细内容之后也会有session进行详细说明，待更新。</p>

<p><hr /></p>

<p><h3>总结</h3>
其他的很多新特性，包括社交网络，GameCenter和PassKit等也会在之后逐渐深入WWDC 2012 Session的时候进行笔记..</p>

<p>作为开篇，就这样吧。<!--:--><!--:en-->&nbsp;</p>

<p><!--:--><!--:ja-->&nbsp;</p>

<p><!--:--></p>
</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>


</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2013 - onevcat -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->







		</div>
	</div>
</body>
</html>
